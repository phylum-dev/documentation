"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([["582"],{3288:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>o,default:()=>h,contentTitle:()=>t,assets:()=>c,toc:()=>l,metadata:()=>s});var s=JSON.parse('{"id":"package_firewall/npm","title":"Phylum NPM Registry","description":"The Phylum NPM registry is based on NPM\'s [Public Registry API].","source":"@site/../docs/package_firewall/npm.md","sourceDirName":"package_firewall","slug":"/package_firewall/npm","permalink":"/package_firewall/npm","draft":false,"unlisted":false,"editUrl":"https://github.com/phylum-dev/documentation/edit/main/docs/package_firewall/npm.md","tags":[],"version":"current","lastUpdatedBy":"Christian Duerr","lastUpdatedAt":1741110928000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Phylum Maven Registry","permalink":"/package_firewall/maven"},"next":{"title":"Phylum NuGet Registry","permalink":"/package_firewall/nuget"}}'),a=r(5893),i=r(65);let o={},t="Phylum NPM Registry",c={},l=[{value:"Configuration",id:"configuration",level:2},{value:"<code>npm</code> and <code>pnpm</code>",id:"npm-and-pnpm",level:3},{value:"<code>yarn</code>",id:"yarn",level:3}];function d(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"phylum-npm-registry",children:"Phylum NPM Registry"})}),"\n",(0,a.jsxs)(n.p,{children:["The Phylum NPM registry is based on NPM's ",(0,a.jsx)(n.a,{href:"https://github.com/npm/registry/blob/main/docs/REGISTRY-API.md",children:"Public Registry API"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,a.jsxs)(n.p,{children:["All configuration options will require a Phylum API key, since Phylum requires\nauthentication. You can find out how to generate one in our\n",(0,a.jsx)(n.a,{href:"/knowledge_base/api-keys#generate-an-api-key",children:"API Keys documentation"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["In the following examples, all API keys will be represented as\n",(0,a.jsx)(n.code,{children:"<PHYLUM_API_KEY>"}),", so make sure to replace them with your generated key."]}),"\n",(0,a.jsxs)(n.p,{children:["Additionally, if the default policy is not sufficient, a group can be passed to\nevaluate all packages against the group's policy. To do this, just replace\n",(0,a.jsx)(n.code,{children:"<PHYLUM_ORG>"})," and ",(0,a.jsx)(n.code,{children:"<PHYLUM_GROUP>"})," with the desired org and group name. The\nsupplied API key ",(0,a.jsx)(n.strong,{children:"must"})," have access to this group."]}),"\n",(0,a.jsxs)(n.p,{children:["If Phylum's default ",(0,a.jsx)(n.a,{href:"/knowledge_base/policy",children:"policy"})," is sufficient, you can omit the username from the\nauthentication details."]}),"\n",(0,a.jsxs)(n.h3,{id:"npm-and-pnpm",children:[(0,a.jsx)(n.code,{children:"npm"})," and ",(0,a.jsx)(n.code,{children:"pnpm"})]}),"\n",(0,a.jsxs)(n.p,{children:["Both ",(0,a.jsx)(n.code,{children:"npm"})," and ",(0,a.jsx)(n.code,{children:"pnpm"})," allow setting custom NPM registries using ",(0,a.jsx)(n.code,{children:"npm"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"npm config set replace-registry-host never\nnpm config set registry https://<PHYLUM_ORG>%2F<PHYLUM_GROUP>:<PHYLUM_API_KEY>@npm.phylum.io/\n"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\u26A0\uFE0F ",(0,a.jsx)(n.strong,{children:"WARNING"})," \u26A0\uFE0F"]}),"\n",(0,a.jsx)(n.p,{children:"Do not accidentally save your token into your shell history."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["A blocked package will show up in ",(0,a.jsx)(n.code,{children:"npm"})," output as E403:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"npm error code E403\nnpm error 403 Could not download <malicious>@<version> due to policy violations:\nnpm error 403 Blocked by package firewall.\nnpm error 403 In most cases, you or one of your dependencies are requesting\nnpm error 403 a package version that is forbidden by your security policy, or\nnpm error 403 on a server you do not have access to.\n"})}),"\n",(0,a.jsxs)(n.p,{children:["If you're using ",(0,a.jsx)(n.code,{children:"pnpm"}),", the output will look like this:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"\u2009ERR_PNPM_NO_VERSIONS\u2009 No versions available for malicious. The package may be unpublished.\n\nThis error happened while installing a direct dependency of /tmp/testing\n"})}),"\n",(0,a.jsx)(n.p,{children:"If a version range is accepted by the manifest, the package manager will\nautomatically attempt to use a version that passes Phylum's policy."}),"\n",(0,a.jsx)(n.h3,{id:"yarn",children:(0,a.jsx)(n.code,{children:"yarn"})}),"\n",(0,a.jsxs)(n.p,{children:["Custom NPM registries can be configured with ",(0,a.jsx)(n.code,{children:"yarn"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'yarn config set -H npmRegistryServer "https://npm.phylum.io/"\nyarn config set -H npmAuthIdent "<PHYLUM_ORG>/<PHYLUM_GROUP:<PHYLUM_API_KEY>"\nyarn config set -H npmAlwaysAuth true\n'})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:["\u26A0\uFE0F ",(0,a.jsx)(n.strong,{children:"WARNING"})," \u26A0\uFE0F"]}),"\n",(0,a.jsx)(n.p,{children:"Do not accidentally save your token into your shell history."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["A blocked package will show up in ",(0,a.jsx)(n.code,{children:"yarn"})," output as missing:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"\u27A4 YN0027: malicious@unknown can't be resolved to a satisfying range\n\u27A4 YN0001: TypeError: Cannot read properties of undefined (reading 'dist')\n    at Fv.getCandidates (/home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:688:7154)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Pg.getCandidates (/home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:141:1271)\n    at async uH (/home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:401:9441)\n    at async /home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:401:8776\n    at async C (/home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:401:7127)\n    at async T2 (/home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:401:8456)\n    at async /home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:402:531\n    at async Promise.all (index 0)\n    at async /home/chris/.cache/node/corepack/v1/yarn/4.5.3/yarn.js:402:488\n\n\u27A4 Errors happened when preparing the environment required to run this command.\n"})}),"\n",(0,a.jsx)(n.p,{children:"Alternatively, if only a specific version is affected:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"\u27A4 YN0000: \xb7 Yarn 4.5.3\n\u27A4 YN0000: \u250C Resolution step\n\u27A4 YN0082: \u2502 malicious@npm:1.0.0: No candidates found\n\u27A4 YN0000: \u2514 Completed in 4s 398ms\n\u27A4 YN0000: \xb7 Failed with errors in 4s 405ms\n"})})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},65:function(e,n,r){r.d(n,{Z:()=>t,a:()=>o});var s=r(7294);let a={},i=s.createContext(a);function o(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);