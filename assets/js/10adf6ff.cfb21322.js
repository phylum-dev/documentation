"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[329],{6932:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>a,frontMatter:()=>c,metadata:()=>r,toc:()=>o});var l=i(5893),s=i(1151);const c={title:"Lockfile Generation",category:"6255e67693d5200013b1fa41",hidden:!1},d=void 0,r={id:"cli/lockfile_generation",title:"Lockfile Generation",description:"The Phylum CLI can generate a lockfile when it is given a manifest file.",source:"@site/../docs/cli/lockfile_generation.md",sourceDirName:"cli",slug:"/cli/lockfile_generation",permalink:"/cli/lockfile_generation",draft:!1,unlisted:!1,editUrl:"https://github.com/phylum-dev/documentation/tree/main/site/../docs/cli/lockfile_generation.md",tags:[],version:"current",lastUpdatedBy:"Christian D\xfcrr",lastUpdatedAt:1701985169,formattedLastUpdatedAt:"Dec 7, 2023",frontMatter:{title:"Lockfile Generation",category:"6255e67693d5200013b1fa41",hidden:!1},sidebar:"cliSidebar",previous:{title:"Supported Lockfiles",permalink:"/cli/supported_lockfiles"},next:{title:"Analyzing Dependencies",permalink:"/cli/analyzing_dependencies"}},t={},o=[{value:"Lockfile generators",id:"lockfile-generators",level:2},{value:"Lockfile detection",id:"lockfile-detection",level:2},{value:"Lockifests",id:"lockifests",level:2},{value:"Example scenario",id:"example-scenario",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.p,{children:"The Phylum CLI can generate a lockfile when it is given a manifest file."}),"\n",(0,l.jsx)(n.h2,{id:"lockfile-generators",children:"Lockfile generators"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Lockfile type"}),(0,l.jsx)(n.th,{children:"Manifests"}),(0,l.jsx)(n.th,{children:"Required tool"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"npm"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"package.json"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://nodejs.org",children:(0,l.jsx)(n.code,{children:"npm"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"yarn"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"package.json"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://yarnpkg.com",children:(0,l.jsx)(n.code,{children:"yarn"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pnpm"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"package.json"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://pnpm.io",children:(0,l.jsx)(n.code,{children:"pnpm"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pip"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"requirements*.txt"})," ",(0,l.jsx)(n.br,{})," ",(0,l.jsx)(n.code,{children:"requirements.in"})," ",(0,l.jsx)(n.br,{})," ",(0,l.jsx)(n.code,{children:"setup.py"})," ",(0,l.jsx)(n.br,{})," ",(0,l.jsx)(n.code,{children:"pyproject.toml"})]}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.a,{href:"https://pip.pypa.io",children:(0,l.jsx)(n.code,{children:"pip"})})," version 23.0.0+"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pipenv"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Pipfile"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://github.com/pypa/pipenv",children:(0,l.jsx)(n.code,{children:"pipenv"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"poetry"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pyproject.toml"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://python-poetry.org",children:(0,l.jsx)(n.code,{children:"poetry"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"gem"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Gemfile"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"bundle"})," (from ",(0,l.jsx)(n.a,{href:"https://bundler.io",children:"Bundler"}),")"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"mvn"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"pom.xml"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"mvn"})," (from ",(0,l.jsx)(n.a,{href:"https://maven.apache.org",children:"Maven"}),")"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"gradle"})}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"build.gradle"})," ",(0,l.jsx)(n.br,{})," ",(0,l.jsx)(n.code,{children:"build.gradle.kts"})]}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://gradle.org",children:(0,l.jsx)(n.code,{children:"gradle"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"go"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"go.mod"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://go.dev",children:(0,l.jsx)(n.code,{children:"go"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"cargo"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"Cargo.toml"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://www.rust-lang.org",children:(0,l.jsx)(n.code,{children:"cargo"})})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"nugetlock"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"*.csproj"})}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://dotnet.microsoft.com",children:(0,l.jsx)(n.code,{children:"dotnet"})})})]})]})]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"TIP:"})}),"\n",(0,l.jsx)(n.p,{children:"For files that can be handled by multiple generators, a fallback is used:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"package.json"})," will use ",(0,l.jsx)(n.code,{children:"npm"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"pyproject.toml"})," will use ",(0,l.jsx)(n.code,{children:"pip"})]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["This can be overridden on the command line with the ",(0,l.jsx)(n.code,{children:"--type"})," (",(0,l.jsx)(n.code,{children:"-t"}),") option. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"phylum analyze -t yarn package.json\n"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"lockfile-detection",children:"Lockfile detection"}),"\n",(0,l.jsx)(n.p,{children:"The Phylum CLI prefers to work directly with lockfiles if they are available. So in a few cases, the CLI will\nautomatically switch and use the corresponding lockfile."}),"\n",(0,l.jsxs)(n.p,{children:["First, if a user runs ",(0,l.jsx)(n.code,{children:"parse"})," or ",(0,l.jsx)(n.code,{children:"analyze"})," on a manifest file without specifying a lockfile type, the Phylum CLI will\nopportunistically switch to the lockfile if it is available in the same directory. For example, ",(0,l.jsx)(n.code,{children:"phylum analyze go.mod"}),"\nwill automatically switch to ",(0,l.jsx)(n.code,{children:"go.sum"})," if available. To override this, simply specify a lockfile type (i.e., ",(0,l.jsx)(n.code,{children:"phylum analyze -t go go.mod"}),")"]}),"\n",(0,l.jsxs)(n.p,{children:["Second, during automatic lockfile detection, manifest files will only be used if there is no corresponding lockfile in\nthe same directory or any parent directory. For example, a single ",(0,l.jsx)(n.code,{children:"Cargo.lock"})," file at the root of the repository will\nbe used instead of looking at any ",(0,l.jsx)(n.code,{children:"Cargo.toml"})," files anywhere in the repository. To avoid this, run ",(0,l.jsx)(n.code,{children:"phylum init"})," and\nspecify all files that you want analyzed."]}),"\n",(0,l.jsxs)(n.p,{children:["Additionally, no lockfile generation will take place if the ",(0,l.jsx)(n.code,{children:"--no-generation"}),"\nflag is passed to ",(0,l.jsx)(n.code,{children:"parse"})," or ",(0,l.jsx)(n.code,{children:"analyze"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"lockifests",children:"Lockifests"}),"\n",(0,l.jsxs)(n.p,{children:["Special handling is given to manifests that, for historical reasons, can also be used as lockfiles. Specifically,\nPython's ",(0,l.jsx)(n.code,{children:"requirements.txt"})," is a manifest file. But in some scenarios it may be fully specified and effectively becomes\na lockfile (e.g., ",(0,l.jsx)(n.code,{children:"pip freeze > requirements.txt"}),")."]}),"\n",(0,l.jsx)(n.p,{children:"Phylum handles these files by first attempting to analyze them as a lockfile. If anything in the file is not fully\nspecified, this will fail, and Phylum will silence the error and proceed to lockfile generation."}),"\n",(0,l.jsx)(n.h2,{id:"example-scenario",children:"Example scenario"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["A user runs ",(0,l.jsx)(n.code,{children:"phylum analyze package.json"})]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["The CLI checks for the existence of a matching lockfile\n(i.e., ",(0,l.jsx)(n.code,{children:"package-lock.json"}),", ",(0,l.jsx)(n.code,{children:"npm-shrinkwrap.json"}),", or ",(0,l.jsx)(n.code,{children:"yarn.lock"}),")"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"If a matching lockfile is found, that file will be used instead"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"If no matching lockfile is found, proceed to manifest file generation"}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["Since no ",(0,l.jsx)(n.code,{children:"--type"})," was specified, the fallback will be used (in this case, ",(0,l.jsx)(n.code,{children:"npm"}),")"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"The lockfile generator runs this command to generate a lockfile:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"npm install --package-lock-only --ignore-scripts\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["The output lockfile (",(0,l.jsx)(n.code,{children:"package-lock.json"}),") is ",(0,l.jsx)(n.a,{href:"https://docs.phylum.io/docs/analyzing_dependencies",children:"analyzed"})]}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>r,a:()=>d});var l=i(7294);const s={},c=l.createContext(s);function d(e){const n=l.useContext(c);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),l.createElement(c.Provider,{value:n},e.children)}}}]);