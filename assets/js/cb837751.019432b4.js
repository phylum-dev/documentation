"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([["4060"],{4193:function(e,t,s){s.r(t),s.d(t,{metadata:()=>i,default:()=>p,frontMatter:()=>o,contentTitle:()=>c,toc:()=>l,assets:()=>r});var i=JSON.parse('{"id":"analytics/suspicious_setup_commands","title":"Suspicious Setup Commands","description":"Description","source":"@site/../docs/analytics/suspicious_setup_commands.md","sourceDirName":"analytics","slug":"/analytics/suspicious_setup_commands","permalink":"/analytics/suspicious_setup_commands","draft":false,"unlisted":false,"editUrl":"https://github.com/phylum-dev/documentation/edit/main/docs/analytics/suspicious_setup_commands.md","tags":[],"version":"current","lastUpdatedBy":"Charles Coggins","lastUpdatedAt":1705602214000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Strange Python Imports","permalink":"/analytics/strange_python_imports"},"next":{"title":"Suspicious URL References","permalink":"/analytics/suspicious_url_references"}}'),n=s(4848),a=s(4429);let o={},c="Suspicious Setup Commands",r={},l=[{value:"Description",id:"description",level:2},{value:"Importance",id:"importance",level:2},{value:"Examples",id:"examples",level:2}];function u(e){let t={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"suspicious-setup-commands",children:"Suspicious Setup Commands"})}),"\n",(0,n.jsx)(t.h2,{id:"description",children:"Description"}),"\n",(0,n.jsxs)(t.p,{children:["In a Python package, the ",(0,n.jsx)(t.code,{children:"setup.py"})," file is a script used for package building and distribution. It is what allows an author to distribute a package through PyPI and it's what allows an end user to then properly install that package for local use. It typically consists of a function called ",(0,n.jsx)(t.code,{children:"setup()"})," that contains metadata-like information such as the name of the package, the version of the package, dependencies, etc. as well as build instructions. This file is automatically run when a user does a ",(0,n.jsx)(t.code,{children:"pip install <package_name>"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"importance",children:"Importance"}),"\n",(0,n.jsx)(t.p,{children:"Because this file is blindly passed to your machine's Python interpreter upon installation, threat actors like to sneak their malicious code into this file because it doesn't even require the victim to use the library; they simply have to install it to trigger the malware deployment. Therefore, it's important to know if any potentially dangerous commands are used in this file."}),"\n",(0,n.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsxs)(t.p,{children:["One of the most prolifically distributed pieces of malware discovered so far in PyPI, the W4SP Stealer, resulted in publishing over 100 separate packages containing W4SP. The attackers often used the ",(0,n.jsx)(t.code,{children:"setup.py"})," file as the first stage of an extremely complicated attack chain."]})]})}function p(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},4429:function(e,t,s){s.d(t,{R:()=>o,x:()=>c});var i=s(6540);let n={},a=i.createContext(n);function o(e){let t=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);